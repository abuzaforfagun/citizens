import * as tslib_1 from "tslib";
import { NODE_TO_PROCESSOR_MAPS } from '../globals';
import { cloneAudioWorkletNodeOptions } from './clone-audio-worklet-node-options';
const createAudioWorkletProcessorPromise = (processorDefinition, audioWorkletNodeOptions) => tslib_1.__awaiter(this, void 0, void 0, function* () {
    const clonedAudioWorkletNodeOptions = yield cloneAudioWorkletNodeOptions(audioWorkletNodeOptions);
    return new processorDefinition(clonedAudioWorkletNodeOptions);
});
export const createAudioWorkletProcessor = (nativeContext, nativeAudioWorkletNode, processorDefinition, audioWorkletNodeOptions) => {
    let nodeToProcessorMap = NODE_TO_PROCESSOR_MAPS.get(nativeContext);
    if (nodeToProcessorMap === undefined) {
        nodeToProcessorMap = new WeakMap();
        NODE_TO_PROCESSOR_MAPS.set(nativeContext, nodeToProcessorMap);
    }
    const audioWorkletProcessorPromise = createAudioWorkletProcessorPromise(processorDefinition, audioWorkletNodeOptions);
    nodeToProcessorMap.set(nativeAudioWorkletNode, audioWorkletProcessorPromise);
    return audioWorkletProcessorPromise;
};
//# sourceMappingURL=/build/es2015/helpers/create-audio-worklet-processor.js.map