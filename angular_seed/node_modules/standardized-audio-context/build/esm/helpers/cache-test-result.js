import { TEST_RESULTS } from '../globals';
var ONGOING_TESTS = new Map();
function cacheTestResult(tester, test) {
    var cachedTestResult = TEST_RESULTS.get(tester);
    if (cachedTestResult !== undefined) {
        return cachedTestResult;
    }
    var ongoingTest = ONGOING_TESTS.get(tester);
    if (ongoingTest !== undefined) {
        return ongoingTest;
    }
    var synchronousTestResult = test();
    if (synchronousTestResult instanceof Promise) {
        ONGOING_TESTS.set(tester, synchronousTestResult);
        return synchronousTestResult
            .then(function (finalTestResult) {
            ONGOING_TESTS.delete(tester);
            TEST_RESULTS.set(tester, finalTestResult);
            return finalTestResult;
        });
    }
    TEST_RESULTS.set(tester, synchronousTestResult);
    return synchronousTestResult;
}
export { cacheTestResult };
//# sourceMappingURL=/build/es2015/helpers/cache-test-result.js.map