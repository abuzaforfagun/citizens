(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('babel-runtime/regenerator'), require('tslib'), require('broker-factory')) :
    typeof define === 'function' && define.amd ? define(['exports', 'babel-runtime/regenerator', 'tslib', 'broker-factory'], factory) :
    (factory((global.asyncArrayBufferBroker = {}),global._regeneratorRuntime,global.tslib_1,global.brokerFactory));
}(this, (function (exports,_regeneratorRuntime,tslib_1,brokerFactory) { 'use strict';

    _regeneratorRuntime = _regeneratorRuntime && _regeneratorRuntime.hasOwnProperty('default') ? _regeneratorRuntime['default'] : _regeneratorRuntime;

    var _this = undefined;
    var wrap = brokerFactory.createBroker({
        allocate: function allocate(_ref) {
            var call = _ref.call;

            return function (length) {
                return tslib_1.__awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {
                    return _regeneratorRuntime.wrap(function _callee$(_context) {
                        while (1) {
                            switch (_context.prev = _context.next) {
                                case 0:
                                    return _context.abrupt('return', call('allocate', { length: length }));

                                case 1:
                                case 'end':
                                    return _context.stop();
                            }
                        }
                    }, _callee, this);
                }));
            };
        },
        deallocate: function deallocate(_ref2) {
            var notify = _ref2.notify;

            return function (arrayBuffer) {
                notify('deallocate', { arrayBuffer: arrayBuffer }, [arrayBuffer]);
            };
        }
    });
    var load = function load(url) {
        var worker = new Worker(url);
        return wrap(worker);
    };

    exports.wrap = wrap;
    exports.load = load;

    Object.defineProperty(exports, '__esModule', { value: true });

})));
